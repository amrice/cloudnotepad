# 前端重写规划

## 项目概述

**目标**：删除现有前端代码，基于相同技术栈重写，解决现有 bug 问题

**技术栈**：
- React 19 + TypeScript
- Tailwind CSS 4
- TipTap 3
- React Router 7
- Zustand 5
- TanStack React Query 5

## 现有问题分析

1. 笔记保存逻辑混乱（标题/内容分离）
2. 侧边栏状态管理不一致
3. 组件职责不清晰
4. Hook 过度拆分，调用关系复杂
5. 类型定义不完整

## 重写原则

1. **单一职责**：每个组件/hook 只做一件事
2. **类型优先**：先定义类型，再写实现
3. **简单直接**：避免过度抽象
4. **测试友好**：组件可独立测试

---

## 目录结构设计

```
src/
├── app/                    # 应用入口
│   ├── App.tsx
│   ├── routes.tsx
│   └── providers.tsx
├── pages/                  # 页面组件
│   ├── HomePage.tsx
│   ├── EditorPage.tsx
│   └── SharePage.tsx
├── components/             # 通用组件
│   ├── ui/                 # 基础 UI 组件
│   ├── editor/             # 编辑器组件
│   └── layout/             # 布局组件
├── features/               # 功能模块
│   ├── notes/              # 笔记功能
│   ├── tags/               # 标签功能
│   └── shares/             # 分享功能
├── hooks/                  # 通用 hooks
├── services/               # API 服务（保留）
├── stores/                 # 状态管理
├── types/                  # 类型定义（保留）
├── utils/                  # 工具函数（保留）
├── styles/                 # 样式文件
│   └── index.css
└── main.tsx
```

---

## 实施阶段

### 阶段 1：基础架构（优先级：P0）

| 任务 | 描述 | 依赖 |
|------|------|------|
| 1.1 | 清理现有代码 | 无 |
| 1.2 | 创建目录结构 | 1.1 |
| 1.3 | 配置入口文件 | 1.2 |
| 1.4 | 实现路由配置 | 1.3 |
| 1.5 | 实现 Provider 层 | 1.3 |

### 阶段 2：UI 组件库（优先级：P0）

| 任务 | 描述 | 依赖 |
|------|------|------|
| 2.1 | Button 组件 | 1.5 |
| 2.2 | Input 组件 | 1.5 |
| 2.3 | Dialog 组件 | 1.5 |
| 2.4 | Loading 组件 | 1.5 |
| 2.5 | Layout 组件 | 1.5 |

### 阶段 3：核心页面（优先级：P0）

| 任务 | 描述 | 依赖 |
|------|------|------|
| 3.1 | HomePage - 笔记列表 | 2.x |
| 3.2 | EditorPage - 编辑器 | 2.x |
| 3.3 | SharePage - 分享页 | 2.x |

### 阶段 4：功能模块（优先级：P1）

| 任务 | 描述 | 依赖 |
|------|------|------|
| 4.1 | 笔记 CRUD | 3.x |
| 4.2 | 自动保存 | 4.1 |
| 4.3 | 标签管理 | 3.1 |
| 4.4 | 分享功能 | 3.2 |

### 阶段 5：优化完善（优先级：P2）

| 任务 | 描述 | 依赖 |
|------|------|------|
| 5.1 | 暗色模式 | 4.x |
| 5.2 | 响应式适配 | 4.x |
| 5.3 | 性能优化 | 5.1, 5.2 |

---

## 验收标准

1. [ ] 所有页面可正常访问
2. [ ] 笔记创建/编辑/删除正常
3. [ ] 标题和内容同步保存
4. [ ] 自动保存功能正常
5. [ ] 暗色模式切换正常
6. [ ] 移动端适配正常
7. [ ] 构建无错误无警告

---

## 保留文件

以下文件/目录保留不删除：
- `functions/` - 后端 API
- `src/services/` - API 服务层
- `src/types/` - 类型定义
- `src/utils/` - 工具函数
- 配置文件（vite.config.ts, tsconfig.json 等）

## 状态

- [x] 阶段 1：基础架构
- [x] 阶段 2：UI 组件库
- [x] 阶段 3：核心页面
- [x] 阶段 4：功能模块
- [x] 阶段 5：优化完善
